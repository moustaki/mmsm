<div class="one-half column" id="processing-sketch">
  <canvas data-processing-sources="/processing/app.pde"></canvas>
</div>
<div class="one-half column">
  <h2>
    <%= monster_greetings %><br/>
    I'm <%= @username %>'s <span class="monster"><%= monster_nickname %></span> <%= monster_shape %>.
  </h2>
  <% if @tracks.any? %>
    <p>
      He's just listened to <%= @tracks.first.title %> by <% @tracks.first.artist.name %>.
      It was <%= track_appreciation(@tracks.first) %>.
    </p>
    <p>My owner also recently enjoyed:</p>
    <ul>
      <% @tracks.each do |track| %>
        <li><%= track.artist.name %> - <%= track.title %></li>
      <% end %>
    </ul>
    
    <% rand_artist = @tracks.sample.artist if @tracks.any? %>
    <% if rand_artist %>
      <h2>I know more than you</h2>
      
      <% subjects = rand_artist.subjects %>
      <% rand_subject = subjects[rand(subjects.size)] %>
      <p>
        <%= rand_artist.name %> is a <%= rand_subject['label'] %>
      </p>
    <% end %>
  
    <h2>Pick a fight!</h2>
    <%= form('/go', :get) %>
      <%= hidden(:user1, :lastfm, :value => @username) %>
      <%= label(:user2, :lastfm, 'Fight Last.fm User Name') %>
      <%= input(:user2, :lastfm) %>
    <%= submit %>
  <% else %>
    <p>My owner doesn't listen to music.</p>
    <p><%= sad_monster %></p>
    
  <% end %>
</div>

<%= erb(:_setup_avatar) %>
